<% content_for :title do %>
  导入问题代码
<% end %>

<div class="panel">
  <h3>导入说明</h3>
  <div class="panel_contents">
    <p>通过CSV文件导入问题代码库。CSV文件应包含以下列：</p>
    <ul>
      <li><strong>EN Code</strong> - 完整问题代码</li>
      <li><strong>Exp. Code</strong> - 费用类型代码</li>
      <li><strong>费用类型</strong> - 费用类型名称</li>
      <li><strong>Issue Code</strong> - 问题类型代码</li>
      <li><strong>问题类型</strong> - 问题类型名称</li>
      <li><strong>SOP描述</strong> - 标准操作流程描述</li>
      <li><strong>标准处理方法</strong> - 问题的标准处理方法</li>
    </ul>
    
    <p>示例CSV格式：</p>
    <pre>
EN Code,Exp. Code,费用类型,Issue Code,问题类型,SOP描述,标准处理方法
EN000101,00,月度交通费,01,燃油费行程问题,根据SOP规定需提供行程,请补充行程信息
EN000102,00,月度交通费,02,金额超标,检查金额是否超过规定限额,要求说明超标原因
EN000201,01,住宿费,01,住宿天数与行程不符,核对住宿天数与行程安排,要求提供行程说明
    </pre>
  </div>
</div>

<div class="panel">
  <h3>导入设置</h3>
  <div class="panel_contents">
    <%= form_tag '/admin/imports/import_problem_codes', multipart: true, class: 'formtastic' do %>
      <fieldset class="inputs">
        <ol>
          <li class="file input optional">
            <label for="file">CSV文件</label>
            <%= file_field_tag :file, accept: '.csv', class: 'file' %>
          </li>
          <li class="select input optional">
            <label for="meeting_type">会议类型</label>
            <%= select_tag :meeting_type, options_for_select([
              ['个人', '个人'],
              ['学术论坛', '学术论坛'],
              ['其他', '其他']
            ], '个人'), class: 'select' %>
            <p class="inline-hints">选择导入数据的会议类型，CSV文件中不包含此信息</p>
          </li>
        </ol>
      </fieldset>
      
      <fieldset class="actions">
        <ol>
          <li class="action input_action">
            <%= submit_tag "导入", class: 'button' %>
          </li>
          <li class="cancel">
            <%= link_to "取消", admin_imports_path %>
          </li>
        </ol>
      </fieldset>
    <% end %>
  </div>
</div>

<div class="panel">
  <h3>注意事项</h3>
  <div class="panel_contents">
    <ul>
      <li>CSV文件必须使用UTF-8编码</li>
      <li>如果费用类型代码已存在，将更新其名称</li>
      <li>如果问题代码在同一费用类型下已存在，将更新其信息</li>
      <li>所有导入的费用类型和问题类型默认为激活状态</li>
    </ul>
  </div>
</div>