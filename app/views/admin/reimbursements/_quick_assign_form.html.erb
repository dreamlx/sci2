<%= form_tag "/admin/reimbursements/quick_assign", method: :post, class: 'quick-assign-form' do %>
  <div class="panel_contents">
    <div class="attributes_table">
      <table>
        <tr>
          <th>选择报销单</th>
          <td>
            <%= select_tag :reimbursement_id, 
                          options_from_collection_for_select(
                            Reimbursement.left_joins(:active_assignment)
                                        .where(reimbursement_assignments: { id: nil })
                                        .order(created_at: :desc)
                                        .limit(20),
                            :id, 
                            ->(r) { "#{r.invoice_number} - #{r.applicant} (#{number_to_currency(r.amount, unit: '¥')})" }
                          ),
                          prompt: "请选择未分配的报销单",
                          class: "chosen-select" %>
          </td>
        </tr>
        <tr>
          <th>选择审核人员</th>
          <td>
            <%= select_tag :assignee_id, 
                          options_from_collection_for_select(AdminUser.all, :id, :email),
                          prompt: "请选择审核人员",
                          class: "chosen-select" %>
          </td>
        </tr>
        <tr>
          <th>分配备注</th>
          <td>
            <%= text_area_tag :notes, nil, rows: 2, placeholder: "请输入分配备注（可选）" %>
          </td>
        </tr>
      </table>
    </div>
  </div>
  
  <div class="actions">
    <%= submit_tag "快速分配", class: "button" %>
    <%= link_to "批量分配", "/admin/reimbursements/batch_assign", class: "button" %>
  </div>
<% end %>

<style>
  .quick-assign-form select {
    width: 100%;
    max-width: 400px;
  }
  
  .quick-assign-form textarea {
    width: 100%;
    max-width: 400px;
  }
</style>