# 快速文档更新操作手册

## 🚀 立即开始：5步更新流程

### 步骤1：识别您的代码变更类型

**问自己：我的变更属于哪种类型？**

| 变更类型 | 例子 | 文档位置 |
|---------|------|----------|
| **功能变更** | 新增报销功能、修改工单逻辑 | `03-development/feature-development/` |
| **数据库变更** | 新表、字段修改、索引优化 | `02-architecture/database/` |
| **API变更** | 接口增删改、参数变化 | `02-architecture/api/` |
| **配置变更** | 环境变量、系统配置修改 | `07-reference/configuration/` |
| **性能优化** | 查询优化、缓存策略 | `07-reference/database/` |
| **部署相关** | 部署流程、环境配置 | `04-deployment/` |

### 步骤2：找到需要更新的具体文档

**使用这个快速查找表**：

```bash
# 功能变更 - 查找相关文档
find docs/03-development/feature-development/ -name "*.md" | grep -E "(报销|工单|费用|导入)"

# 数据库变更 - 查找相关文档
find docs/02-architecture/database/ -name "*.md"

# 配置变更 - 查找相关文档
find docs/07-reference/configuration/ -name "*.md"
```

### 步骤3：更新文档内容

**按照这个模板更新**：

```markdown
## 更新记录

### 2025-08-19 更新
**变更内容**: [描述您的变更]
**影响范围**: [说明影响的功能或模块]
**相关代码**: [涉及的文件或类名]
**操作说明**: [具体的操作步骤]

#### 变更详情
- [ ] 功能描述更新
- [ ] 实现方法说明
- [ ] API接口变更
- [ ] 数据库影响
- [ ] 测试用例更新
```

### 步骤4：检查关联文档

**必须同时更新的关联文档**：

| 主要文档位置 | 关联文档位置 |
|-------------|-------------|
| `03-development/feature-development/` | `02-architecture/system-design/` |
| `02-architecture/database/` | `07-reference/database/` |
| `04-deployment/production/` | `05-operations/maintenance/` |
| 任何功能文档 | `03-development/testing/` |

### 步骤5：验证和提交

**检查清单**：
- [ ] 文档内容与代码一致
- [ ] 所有相关文档都已更新
- [ ] 文档链接正确
- [ ] 格式规范统一

**提交格式**：
```bash
git add docs/
git commit -m "docs: 更新[功能名称]相关文档

- 更新功能开发文档
- 修改数据库设计说明
- 补充测试用例文档

相关代码变更: [代码commit ID或PR链接]"
```

## 📝 实际示例

### 示例：您刚刚修改了报销服务

**1. 识别变更类型**：功能变更

**2. 找到文档**：
```bash
# 查找报销相关文档
find docs/ -name "*.md" | xargs grep -l "报销"
```

**3. 更新这些文档**：
- `docs/03-development/feature-development/报销分配功能.md`
- `docs/03-development/feature-development/报销状态逻辑冲突分析.md`
- `docs/02-architecture/system-design/用户故事与交互设计.md`

**4. 更新内容示例**：
```markdown
## 2025-08-19 更新
**变更内容**: 优化报销状态判断逻辑
**影响范围**: 报销单审批流程
**相关代码**: app/services/reimbursement_authorization_service.rb
**操作说明**: 修改了状态机配置，增加了新的状态转换规则

#### 变更详情
- [x] 功能描述更新 - 新增状态转换说明
- [x] 实现方法说明 - 更新服务调用流程
- [x] API接口变更 - 无接口变更
- [x] 数据库影响 - 无数据库变更
- [x] 测试用例更新 - 需要新增状态转换测试
```

## 🛠️ 快速工具脚本

### 创建一个快速更新脚本

```bash
#!/bin/bash
# quick-doc-update.sh

echo "=== 快速文档更新工具 ==="

# 获取最近的代码变更
echo "最近的代码变更："
git log --oneline -5

# 提示用户输入变更类型
echo "请选择变更类型："
echo "1. 功能变更"
echo "2. 数据库变更"
echo "3. 配置变更"
echo "4. API变更"
echo "5. 性能优化"

read -p "输入数字 (1-5): " choice

case $choice in
  1)
    echo "功能变更 - 请更新以下文档："
    find docs/03-development/feature-development/ -name "*.md"
    ;;
  2)
    echo "数据库变更 - 请更新以下文档："
    find docs/02-architecture/database/ -name "*.md"
    ;;
  3)
    echo "配置变更 - 请更新以下文档："
    find docs/07-reference/configuration/ -name "*.md"
    ;;
  4)
    echo "API变更 - 请更新以下文档："
    find docs/02-architecture/api/ -name "*.md"
    ;;
  5)
    echo "性能优化 - 请更新以下文档："
    find docs/07-reference/database/ -name "*.md"
    ;;
esac

echo "=== 更新完成检查清单 ==="
echo "1. 文档内容是否与代码一致？"
echo "2. 所有相关文档是否都已更新？"
echo "3. 文档链接是否正确？"
echo "4. 格式是否规范统一？"
```

## 📋 每日检查清单

### 开发人员每日检查
- [ ] 今天的代码变更是否需要更新文档？
- [ ] 相关的文档是否已经更新？
- [ ] 文档更新是否已经提交？

### 每周检查
- [ ] 本周所有代码变更的文档更新情况
- [ ] 文档与代码的一致性检查
- [ ] 文档链接有效性检查

## 🆘 遇到问题？

### 常见问题

**Q: 我不知道要更新哪个文档？**
A: 使用 `find docs/ -name "*.md" | xargs grep -l "关键词"` 搜索相关关键词

**Q: 文档更新后如何验证？**
A: 按照文档中的步骤实际操作一遍，看是否与代码行为一致

**Q: 如何确保不遗漏关联文档？**
A: 查看本文档的"关联文档"部分，或使用 `grep -r "相关文档" docs/` 查找

### 紧急联系
如果发现文档与代码严重不一致，立即：
1. 更新相关文档
2. 在团队群中通知
3. 记录到 `docs/05-operations/maintenance/文档一致性检查指南.md`

---

**记住**: 每次代码变更都是更新文档的机会！